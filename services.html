<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Услуги Онлайн</title>
<link rel="stylesheet" href="css/style.css">

<!-- VarioQub -->
<script type="text/javascript">
(function(e, x, pe, r, i, me, nt){
    e[i]=e[i]||function(){(e[i].a=e[i].a||[]).push(arguments)};
    me=x.createElement(pe); me.async=1; me.src=r;
    nt=x.getElementsByTagName(pe)[0];
    nt.parentNode.insertBefore(me,nt);
})(window, document, 'script', 'https://abt.s3.yandex.net/expjs/latest/exp.js', 'ymab');

ymab('metrika.106324646', 'init');
</script>
</head>

<body>

<header>
    <nav>
        <div class="logo">Услуги Онлайн</div>
        <ul class="menu">
            <li><a href="index.html">Главная</a></li>
            <li><a href="services.html">Услуги</a></li>
            <li><a href="contact.html">Контакты</a></li>
        </ul>
    </nav>
</header>

<main>
    <h1>Наши услуги</h1>

    <div class="services-container">
        <div class="service" data-page="service1.html">
            <h3>Услуга 1</h3>
            <p>Описание услуги 1</p>
            <button class="buy-btn">Ознакомиться и купить</button>
            <button class="try-free-btn">Пробовать бесплатно</button>
        </div>

        <div class="service" data-page="service2.html">
            <h3>Услуга 2</h3>
            <p>Описание услуги 2</p>
            <button class="buy-btn">Ознакомиться и купить</button>
            <button class="try-free-btn">Пробовать бесплатно</button>
        </div>
    </div>
</main>

<!-- MAIN JS -->
<script>
(function () {

    function showFreeButton() {
        // Ждём пока ymab определён
        if (typeof ymab === 'undefined') {
            requestAnimationFrame(showFreeButton);
            return;
        }

        ymab('getFlags', function(flagsArray){
            if (!Array.isArray(flagsArray)) return;
            const flag = flagsArray.find(f => f.n === 'show_free_button');
            if (!flag) return;

            // Все варианты true
            if (flag.v === true || flag.v === 'true' || flag.v === '1') {
                document.querySelectorAll('.try-free-btn')
                    .forEach(btn => btn.style.display = 'inline-block');
            }
        });

        // Навигация кнопок
        document.querySelectorAll('.buy-btn').forEach(btn => {
            btn.addEventListener('click', e => {
                const service = e.target.closest('.service');
                if (service?.dataset.page) window.location.href = service.dataset.page;
            });
        });

        document.querySelectorAll('.try-free-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                window.location.href = 'free-info.html';
            });
        });
    }

    // Ждём полной загрузки DOM
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', showFreeButton);
    } else {
        showFreeButton();
    }

})();
</script>

</body>
</html>
