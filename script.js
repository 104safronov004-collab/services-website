// -------------------------------
// Рендер контента для каждой услуги
// -------------------------------
function renderService(service) {
  const content = document.getElementById("content");
  if (!content) return;

  let servicesData = {
    law: [
      {
        title: "Инструкция по правовой безопасности",
        text: "Данный документ описывает основные правила и процедуры, которые необходимо соблюдать для обеспечения правовой безопасности в организации.<br>" +
"Он включает в себя основные аспекты: соблюдение законодательства, контроль за проведением юридических процедур, а также защиту прав сотрудников и клиентов.<br>" +
"Рекомендуется регулярно проходить обучение и информировать персонал о возможных рисках и способах их минимизации.<br>" +
"Обязательно документируйте все действия, связанные с юридическими вопросами, чтобы иметь возможность предоставлять доказательства при необходимости."
      },
      {
        title: "Шаблоны договоров",
        text: "Шаблоны договоров представляют собой образцы юридических документов, которые можно использовать для различных сделок и соглашений.<br>" +
"Данный документ содержит примеры, которые помогут избежать юридических ошибок и недоразумений при составлении договоров.<br>" +
"Важно, чтобы шаблоны адаптировались под конкретные ситуации и нужды, а также учитывали особенности законодательства.<br>" +
"Каждый шаблон должен быть проверен юристом перед его использованием в официальных сделках."
      },
      {
        title: "Договор аренды",
        text: "Шаблоны договоров, инструкции и образцы документов для предприятий."
      }, 
      {
        title: "Договор купли-продажи",
        text: "Шаблоны договоров, инструкции и образцы документов для предприятий."
      }, 
      {
        title: "Уведомление о расторжении договора",
        text: "Шаблоны договоров, инструкции и образцы документов для предприятий."
      }, 
      {
        title: "Регламент внутреннего документооборота",
        text: "Шаблоны договоров, инструкции и образцы документов для предприятий."
      }
    ],
    ot: [
      {
        title: "Инструкция по охране труда",
        text: "Инструкция по охране труда является ключевым документом для обеспечения безопасности работников на предприятии.<br>" +
"Она описывает основные требования, правила и процедуры, которые должны соблюдаться для предотвращения несчастных случаев.<br>" +
"Важно регулярно проводить инструктажи, чтобы сотрудники были в курсе актуальных угроз и мер предосторожности.<br>" +
"Также необходимо фиксировать все случаи обращения работников с просьбами о проведении дополнительных инструктажей или улучшении условий труда."
      },
      {
        title: "Журнал охраны труда",
        text: "Журнал охраны труда служит для регистрации всех соответствующих действий и событий на предприятии.<br>" +
"В нем фиксируются проведенные инструктажи, обучение и другие мероприятия, связанные с безопасностью труда.<br>" +
"Это важный документ для проверки соответствия нормам охраны труда.<br>" +
"Рекомендуется вести журнал в электронном виде, чтобы упростить доступ к информации и упорядочить данные."
      },
      {
        title: "План эвакуации",
        text: "Журналы, приказы и программы обучения по охране труда."
      },
      {
        title: "Инструкция по работе с огнестрельным оружием",
        text: "Журналы, приказы и программы обучения по охране труда."
      },
      {
        title: "Форма отчета по охране труда",
        text: "Журналы, приказы и программы обучения по охране труда."
      },
      {
        title: "Журнал регистрации инструктажей",
        text: "Журналы, приказы и программы обучения по охране труда."
      },
      {
        title: "Программа обучения по охране труда",
        text: "Журналы, приказы и программы обучения по охране труда."
      }
    ],
    pb: [
      {
        title: "Документы по промышленной безопасности",
        text: "Документы по промышленной безопасности содержат все необходимые инструкции и меры предосторожности, связанные с безопасной эксплуатацией оборудования и технологий.<br>" +
"Они помогают минимизировать риски и избежать аварий на производстве.<br>" +
"Каждый документ должен быть доступен всем сотрудникам и регулярно обновляться в соответствии с изменениями в законодательстве.<br>" +
"Важно проводить обучения для работников, чтобы они были осведомлены о необходимых мерах безопасности."
      },
      {
        title: "Шаблоны инструкций",
        text: "Шаблоны инструкций используются для создания документов, которые описывают процедуры и правила, касающиеся эксплуатации оборудования или выполнения работ.<br>" +
"Правильное заполнение шаблонов позволяет обеспечить единообразие и соответствие стандартам.<br>" +
"Каждый шаблон должен быть проверен на соответствие действующему законодательству и внутренним регламентам компании.<br>" +
"Важно включать в инструкции ясные и доступные формулировки, чтобы они были понятны всем работникам."
      },
      {
        title: "Должностная инструкция по безопасности труда",
        text: "Шаблоны инструкций по Промбезопасности."
      },
      {
        title: "Анализ рисков",
        text: "Шаблоны инструкций по Промбезопасности."
      },
      {
        title: "Порядок проведения инструктажей",
        text: "Шаблоны инструкций по Промбезопасности."
      },
      {
        title: "План профилактических мероприятий",
        text: "Шаблоны инструкций по Промбезопасности."
      },
      {
        title: "Список средств индивидуальной защиты (СИЗ)",
        text: "Шаблоны инструкций по Промбезопасности."
      }
    ]
  };

  let html = "";
  if (servicesData[service]) {
    servicesData[service].forEach(doc => {
      html += `
        <div class="document">
          <h4 class="document-title" onclick="toggleText(this)" style="cursor: pointer; text-decoration: underline;">${doc.title}</h4>
          <p class="document-text" style="display: none;">${doc.text}</p>
        </div>
      `;
    });
  } else {
    html = "<p>Документы не найдены.</p>";
  }

  content.innerHTML = html;
}

// Функция для отображения/скрытия текста документа
function toggleText(element) {
  const textElement = element.nextElementSibling;
  if (textElement.style.display === "none" || !textElement.style.display) {
    textElement.style.display = "block";
  } else {
    textElement.style.display = "none";
  }


  content.innerHTML = html;
  content.classList.add("blur"); // по умолчанию размытый
}

// -------------------------------
// Универсальная функция подписки
// -------------------------------
function handleSubscription(service) {
  const content = document.getElementById("content");
  if(!content) return;

  // 1. Рендерим контент
  renderService(service);

  // 2. Проверяем подписку
  const notice = document.getElementById("subscriptionNotice");
  const paidDate = localStorage.getItem("paidDate_" + service);
  const now = new Date();
  let daysLeft = 0;

  if(paidDate) {
    const startDate = new Date(paidDate);
    const diffTime = now - startDate;
    daysLeft = 30 - Math.floor(diffTime / (1000 * 60 * 60 * 24));
  }

  if(daysLeft > 0) {
    // Подписка активна
    if(notice) {
      notice.style.display = "block";
      document.getElementById("daysLeft").innerText = daysLeft;
    }
    content.classList.remove("blur"); // показываем контент
  } else {
    // Подписка истекла
    if(notice) notice.style.display = "none";
    content.classList.add("blur"); // снова размываем
    localStorage.removeItem("paid_" + service);
    localStorage.removeItem("paidDate_" + service);
  }
}

// -------------------------------
// Начало оплаты (кнопка "Купить подписку")
// -------------------------------
function goPay(service) {
  localStorage.setItem("currentPay", service);
  location.href = "payment.html"; // Переход на страницу оплаты
}

// -------------------------------
// Оплата на странице payment.html
// -------------------------------
function pay() {
  const service = localStorage.getItem("currentPay");
  if(!service) return;

  // Сохраняем факт оплаты и дату
  localStorage.setItem("paid_" + service, "true");
  localStorage.setItem("paidDate_" + service, new Date().toISOString());

  // Показать снек уведомление
  const snack = document.getElementById("snack");
  if(snack) {
    snack.style.display = "block";
    setTimeout(() => snack.style.display = "none", 3000);
  }

  // Возврат на страницу услуг
  location.href = "services.html";
}
